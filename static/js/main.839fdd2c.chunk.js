(this["webpackJsonpcity-pop"]=this["webpackJsonpcity-pop"]||[]).push([[0],{17:function(e,t,n){},20:function(e,t,n){e.exports=n(33)},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(18),o=n.n(c),u=n(8),s=n(1),i=function(){return r.a.createElement("div",{className:"button-container"},r.a.createElement(u.b,{to:{pathname:"/search",state:{searchType:"city"}}},r.a.createElement("button",{type:"button",className:"start-button bordered-button"},"SEARCH BY CITY")),r.a.createElement(u.b,{to:{pathname:"/search",state:{searchType:"country"}}},r.a.createElement("button",{type:"button",className:"start-button bordered-button"},"SEARCH BY COUNTRY")))},l=n(5),m=(n(17),function(e){var t=e.text;return r.a.createElement("div",{className:"description"},"".concat(t.toUpperCase()))});window.city="textCity";var p=function(e){var t=e.location.state.searchType,n=Object(s.f)(),c=Object(a.useState)(""),o=Object(l.a)(c,2),u=o[0],i=o[1],p=function(){console.log("handleSearch");var e=document.querySelector("#search-field").value;"city"===t?function(e){var t="http://api.geonames.org/searchJSON?name_equals=".concat(e,"&featureClass=P&city=cities15000&maxRows=1&username=ytterdorr");fetch(t).then((function(e){return e.json()})).then((function(t){if(t.geonames.length>0){var a=t.geonames[0];a.population<1500?i("Could not find city: ".concat(e)):(i(""),n.push("/cityPop?city=".concat(a.geonameId)))}else i("Could not find city: ".concat(e))}))}(e):"country"===t?function(e){var t="http://api.geonames.org/searchJSON?name_equals=".concat(e,"&featureCode=PCLI&maxRows=1&username=ytterdorr");fetch(t).then((function(e){return e.json()})).then((function(t){if(console.log(t),t.totalResultsCount>0){var a=t.geonames[0];console.log(a.name,a.countryCode,a.geonameId),n.push("/country?country=".concat(a.geonameId))}else i("No country found, ".concat(e))}))}(e):console.log("[handleSearch]: Unknown search type '".concat(t,"'"))};return r.a.createElement("div",{className:"search-container"},r.a.createElement(m,{text:"Search by ".concat(t)}),r.a.createElement("input",{type:"text",name:"search-field",id:"search-field",placeholder:"Enter a ".concat(t),onKeyDown:function(e){"Enter"===e.key&&p()}}),u?r.a.createElement("div",{id:"error-box"},u):null,r.a.createElement("button",{type:"button",id:"search-button",onClick:p},r.a.createElement("i",{className:"fas fa-search"})))},f=n(6),h=n.n(f),d=n(10),y=function(e){var t=Object(a.useState)(!0),n=Object(l.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(""),s=Object(l.a)(u,2),i=s[0],p=s[1],f=Object(a.useState)(""),y=Object(l.a)(f,2),b=y[0],E=y[1],g=Object(a.useState)(""),v=Object(l.a)(g,2),w=v[0],O=v[1],j=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=window.location.search,n=new URLSearchParams(t),a=n.get("city"),console.log("Got city:",a),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:t=e.sent,console.log("geoId",t),n="http://api.geonames.org/getJSON?geonameId=".concat(t,"&username=ytterdorr&style=short"),fetch(n).then((function(e){return e.json()})).then((function(e){if(console.log("data",e),"P"===e.fcl){var t=e;console.log("pop (".concat(t.name,"): ").concat(t.population)),O(t.name),E(t.population),o(!1)}else p("No city found")}));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){N()}),[]),r.a.createElement("div",{className:"centered-column"},c?r.a.createElement(m,{text:"Loading..."}):r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{text:w}),r.a.createElement("div",{className:"population-display"},r.a.createElement("p",{className:"small-text"},"Population"),r.a.createElement("p",{className:"population-number"},b.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")))),i?r.a.createElement("p",{className:"error"},i):null)},b=function(e){var t=e.name,n=e.id;return r.a.createElement(u.b,{to:"/cityPop?city=".concat(n)},r.a.createElement("button",{type:"button",className:"city-button bordered-button"},t))},E=function(){var e=Object(a.useState)(!0),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),u=Object(l.a)(o,2),s=u[0],i=u[1],p=Object(a.useState)(""),f=Object(l.a)(p,2),y=f[0],E=f[1],g=Object(a.useState)([]),v=Object(l.a)(g,2),w=v[0],O=v[1],j=function(){var e=window.location.search;return new URLSearchParams(e).get("country")},N=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="http://api.geonames.org/searchJSON?country=".concat(t,"&featureClass=P&city=cities15000&maxRows=3&username=ytterdorr"),a=[],e.next=4,fetch(n).then((function(e){return e.json()})).then((function(e){e.geonames.length>0?a=e.geonames:i("No cities found, ".concat(t))}));case 4:return e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){var e=Object(d.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="http://api.geonames.org/getJSON?geonameId=".concat(t,"&username=ytterdorr&style=short"),e.next=3,fetch(n).then((function(e){return e.json()})).then((function(e){a=e}));case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=function(){var e=Object(d.a)(h.a.mark((function e(){var t,n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=j(),e.next=3,x(t);case 3:return n=e.sent,e.next=6,N(n.countryCode);case 6:a=e.sent,E(n.name),O(a),c(!1);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){S()}),[]),r.a.createElement("div",{className:"centered-column"},n?r.a.createElement(m,{text:"Loading..."}):r.a.createElement(r.a.Fragment,null,r.a.createElement(m,{text:y}),r.a.createElement("div",{className:"citylist-container centered-column"},w.map((function(e){return r.a.createElement(b,{name:e.name,id:e.geonameId,key:e.geonameId})})))),s?r.a.createElement("p",{className:"error"},s):null)},g=(n(31),n(32),function(){return r.a.createElement("div",null,"Sorry, nothing here")});var v=function(){return Object(a.useEffect)((function(){!function(){console.log("[Force http]");var e=window.location.href;"s"==e[4]&&(window.location.href=e.substring(0,4)+e.substring(5))}()})),r.a.createElement("div",{className:"container"},r.a.createElement("header",{className:"App-header"},r.a.createElement("h1",null,"CityPop")),r.a.createElement("main",null,r.a.createElement(u.a,null,r.a.createElement(s.c,null,r.a.createElement(s.a,{exact:!0,path:"/"},r.a.createElement(i,null)),r.a.createElement(s.a,{path:"/search",render:function(e){return r.a.createElement(p,e)}}),r.a.createElement(s.a,{path:"/cityPop"},r.a.createElement(y,null)),r.a.createElement(s.a,{path:"/country"},r.a.createElement(E,null)),r.a.createElement(g,{default:!0})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[20,1,2]]]);
//# sourceMappingURL=main.839fdd2c.chunk.js.map